<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formulario de Pedido AWS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <div class="max-w-5xl mx-auto bg-white shadow-lg rounded-xl p-6 space-y-6">
    <h1 class="text-3xl font-bold text-center text-gray-800">Formulario de Pedido</h1>

    <!-- Datos del Cliente -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <input type="text" placeholder="Nombre del Cliente" class="border p-2 rounded w-full" />
      <input type="text" placeholder="Razón Social" class="border p-2 rounded w-full" />
      <input type="text" placeholder="CUIT" class="border p-2 rounded w-full" />
      <select class="border p-2 rounded w-full">
        <option value="">Situación Fiscal</option>
        <option value="Responsable Inscripto">Responsable Inscripto</option>
        <option value="Monotributista">Monotributista</option>
        <option value="Exento">Exento</option>
        <option value="No Responsable">No Responsable</option>
        <option value="Consumidor Final">Consumidor Final</option>
      </select>
      <input type="text" placeholder="Dirección Legal" class="border p-2 rounded w-full" />
      <input type="text" placeholder="Dirección de Entrega" class="border p-2 rounded w-full" />
      <input type="text" placeholder="Lugar de Entrega" class="border p-2 rounded w-full" />
      <input type="date" class="border p-2 rounded w-full" />
    </div>

    <!-- Productos -->
    <div id="productos" class="space-y-4"></div>

    <button type="button" onclick="agregarLinea()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
      + Agregar producto
    </button>

    <!-- Condiciones de pago -->
    <input type="text" placeholder="Condición de Pago" class="border p-2 rounded w-full" />

    <!-- Vista previa del pedido -->
    <div>
      <label class="font-bold">Resumen para WhatsApp:</label>
      <textarea id="resumenPedido" class="border p-2 rounded w-full mt-2" rows="8" readonly></textarea>
    </div>

    <!-- Botón enviar por WhatsApp -->
    <a id="btnWhatsapp" target="_blank" class="block bg-green-600 text-white text-center py-3 rounded font-bold">
      Enviar pedido por WhatsApp
    </a>
  </div>

  <script>
    const bodegas = {
      "A Corazon Abierto": [
        "Malbec Etiqueta Negra",
        "Cabernet Franc Etiqueta Negra",
        "Cabernet Sauvignon Etiqueta Negra",
        "Gran Malbec",
        "Gran Corte"
      ],
      "Amosa": [
        "Chardonnay",
        "Rosé",
        "Malbec de la Casa",
        "Gran Blend"
      ],
      "Familia Kretschmar": [
        "Chupasangre Cabernet Sauvignon",
        "Chupasangre Malbec",
        "Chupasangre Malbec Rosé",
        "Chupasangre Gran Corte Blend",
        "Sanguinaria Malbec",
        "Sanguinaria Cabernet Franc",
        "4 Brotes Malbec"
      ],
      "Tiammat": [
        "N° 7",
        "N° 9",
        "N° 10",
        "N° 11",
        "N° 12",
        "N° 14"
      ],
      "Iaccarini": [
        "Via Blanca White Blend",
        "Via Blanca Malbec",
        "Via Blanca Bonarda",
        "Via Blanca Cabernet Sauvignon",
        "Via Blanca Red Blend",
        "Via Blanca Terroir Selection Malbec",
        "Via Blanca Terroir Selection Cabernet Sauvignon"
      ]
    };

    function crearLinea(index) {
      const div = document.createElement('div');
      div.className = "grid grid-cols-1 md:grid-cols-3 gap-2";

      const selectBodega = document.createElement('select');
      selectBodega.className = "border p-2 rounded";
      selectBodega.innerHTML = `<option value="">Seleccione Bodega</option>` +
        Object.keys(bodegas).map(b => `<option value="${b}">${b}</option>`).join('');
      selectBodega.onchange = function () {
        selectProducto.innerHTML = '<option value="">Seleccione Producto</option>';
        if (bodegas[selectBodega.value]) {
          bodegas[selectBodega.value].forEach(prod => {
            const option = document.createElement('option');
            option.value = prod;
            option.textContent = prod;
            selectProducto.appendChild(option);
          });
        }
        generarResumen();
      };

      const selectProducto = document.createElement('select');
      selectProducto.className = "border p-2 rounded";
      selectProducto.innerHTML = '<option value="">Seleccione Producto</option>';
      selectProducto.onchange = generarResumen;

      const inputCantidad = document.createElement('input');
      inputCantidad.type = "number";
      inputCantidad.min = "1";
      inputCantidad.placeholder = "Cantidad";
      inputCantidad.className = "border p-2 rounded";
      inputCantidad.oninput = generarResumen;

      div.appendChild(selectBodega);
      div.appendChild(selectProducto);
      div.appendChild(inputCantidad);

      return div;
    }

    function agregarLinea() {
      const container = document.getElementById('productos');
      container.appendChild(crearLinea(container.children.length));
    }

    function generarResumen() {
      const productosDiv = document.getElementById('productos');
      const lineas = productosDiv.querySelectorAll('.grid');
      let resumen = '';

      lineas.forEach((linea, index) => {
        const [bodega, producto, cantidad] = linea.querySelectorAll('select, input');
        if (bodega.value && producto.value && cantidad.value) {
          resumen += `Producto ${index + 1}:\nBodega: ${bodega.value}\nProducto: ${producto.value}\nCantidad: ${cantidad.value}\n\n`;
        }
      });

      document.getElementById('resumenPedido').value = resumen.trim();
      document.getElementById('btnWhatsapp').href = "https://wa.me/?text=" + encodeURIComponent(resumen.trim());
    }

    for (let i = 0; i < 5; i++) agregarLinea();
  </script>
</body>
</html>
